---
- name: create and enable php-fpm vhost
  become: true
  template: src=nginx_vhost.conf dest=/etc/nginx/conf.d/fpm.conf
  vars: { port: "{{ fpm_port }}", fcgi: 9000 }
  when: fpm_port is defined and fpm_port|int >= 1
  notify:
    - restart nginx service
  tags: nginx_vhost

- name: create and enable hhvm vhost
  become: true
  template: src=nginx_vhost.conf dest=/etc/nginx/conf.d/hhvm.conf
  vars: { port: "{{ hhvm_port }}", fcgi: 9001 }
  when: hhvm_port is defined and hhvm_port|int >= 1
  notify:
    - restart nginx service
  tags: nginx_vhost

- debug: msg=whoop
  when: hhvm_port is defined and hhvm_port|int >= 1
  tags: debug
